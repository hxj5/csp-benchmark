
Datasets
========

Benchmarking requires all dependent datasets to be well prepared beforehand.
All datasets should be downloaded to ``DATA_DIR``. Its value could be specified
in `config.sh`_. Please make sure that the ``DATA_DIR`` should have the same 
directory structure and file names as the `data dir`_ since many file names 
are hard-coded in scripts.

Preparation
-----------

1. Demuxlet Dataset
~~~~~~~~~~~~~~~~~~~

The demuxlet dataset is a 10x scRNA-seq dataset which was published in 
demuxlet (`Kang et al`_., 2018). The GEO access number is GSE96583. For this
benchmarking, it's the batch 1 sample B (GSM2560246) that was downloaded and used.

BAM file
++++++++

``demux.B.merged.bam`` (~19G). It was downloaded from `SRR5398236`_ and renamed to
demux.B.merged.bam. This file is based on hg19.

Barcode file
++++++++++++

``demux.B.barcodes.tsv``. It was downloaded from `GSM2560246_barcodes.tsv.gz`_ and
then unzipped and renamed to demux.B.barcodes.tsv.

.. _Kang et al: https://www.nature.com/articles/nbt.4042
.. _SRR5398236: https://sra-pub-src-1.s3.amazonaws.com/SRR5398236/B.merged.bam.1
.. _GSM2560246_barcodes.tsv.gz: https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSM2560246&format=file&file=GSM2560246%5Fbarcodes%2Etsv%2Egz

2. Souporcell Dataset
~~~~~~~~~~~~~~~~~~~~~

The souporcell dataset is a 10x scRNA-seq dataset which was published in 
souporcell (`Heaton et al`_., 2020). For this benchmarking, 64 fastq files
of `the 32 runs`_ of ENA sample `SAMEA4810598 euts_1`_ (~34G in total) were
downloaded and then aligned to human genome reference hg19 by CellRanger 
count pipeline v4.0.0 with `soupc.preprocess.qsub.sh`_.

BAM file
++++++++

``soupc.bam`` (~31G). It was generated by CellRanger and renamed from 
``outs/possorted_genome_bam.bam`` to soupc.bam.

Barcode file
++++++++++++

``soupc.barcodes.tsv``. It was generated by CellRanger and renamed from
``outs/filtered_feature_bc_matrix/barcodes.tsv`` to soupc.barcodes.tsv.

Genotyping array calls
++++++++++++++++++++++

``soupc.gtarray.vcf.gz`` (~11M). It was downloaded from `HipSci euts_1`_ cell 
line database and renamed from
``HPSI0914i-euts_1.wec.gtarray.HumanCoreExome-12_v1_0.20160912.genotypes.vcf.gz``
to soupc.gtarray.vcf.gz. It contains genotype calls of euts_1 cell line that 
were generated by Infinium HumanExome BeadChip. This file is based on hg19.

.. _Heaton et al: https://www.nature.com/articles/s41592-020-0820-1
.. _the 32 runs: https://github.com/hxj5/csp-benchmark/blob/master/scripts/soupc.samples.lst
.. _SAMEA4810598 euts_1: https://www.ebi.ac.uk/ena/browser/view/SAMEA4810598
.. _soupc.preprocess.qsub.sh: https://github.com/hxj5/csp-benchmark/blob/master/scripts/soupc.preprocess.qsub.sh
.. _HipSci euts_1: https://www.ebi.ac.uk/ena/browser/view/ERZ368756

3. Cardelino dataset
~~~~~~~~~~~~~~~~~~~~

The cardelino dataset is a Smart-seq2 scRNA-seq dataset which was published in 
cardelino (`McCarthy et al`_., 2020). For this benchmarking, the first 10 fastq
files (~224M in total) of sample `joxm`_ were downloaded. The 10 files were 
generated by 5 runs ERR2806033 ~ ERR2806037 with paired fastq files for each run. 
The files were aligned to human genome reference hg19 by STAR v2.7.6a with
`carde.preprocess.qsub.sh`_.

BAM file list
+++++++++++++

``carde.bam.lst``. It contains absolute file paths to the 5 BAM files generated
above, one file path per line (`example bam file list`_ is provided).

Sample list
+++++++++++

``carde.sample.lst``. It contains 5 sample names of the 5 BAM files generated
above, one sample name per line (`example sample list`_ is provided).

.. _McCarthy et al: https://www.nature.com/articles/s41592-020-0766-3
.. _joxm: https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-7167/samples/?full=true&s_sortby=col_42&s_sortorder=ascending&s_page=14&s_pagesize=100
.. _carde.preprocess.qsub.sh: https://github.com/hxj5/csp-benchmark/blob/master/scripts/carde.preprocess.qsub.sh
.. _example bam file list: https://github.com/hxj5/csp-benchmark/blob/master/data/cardelino/carde.bam.lst
.. _example sample list: https://github.com/hxj5/csp-benchmark/blob/master/data/cardelino/carde.sample.lst

4. Candidate SNP VCF file
~~~~~~~~~~~~~~~~~~~~~~~~~

``genome1K.phase3.SNP_AF5e2.chr1toX.hg19.snp.uniq.vcf.gz`` (~85M) contains
~7.36M SNPs based on hg19. A script `snp_preprocess.sh`_ was used to 
filter SNPs of type indels, multi-alleles or duplicates from 
`genome1K.phase3.SNP_AF5e2.chr1toX.hg19.vcf.gz`_, which was based on 
1000 genome project and only kept SNPs on chr1-22 and X with minor allele 
frequency (MAF) > 0.05, to output 
genome1K.phase3.SNP_AF5e2.chr1toX.hg19.snp.uniq.vcf.gz.

.. _snp_preprocess.sh: https://github.com/hxj5/csp-benchmark/blob/master/scripts/snp_preprocess.sh
.. _genome1K.phase3.SNP_AF5e2.chr1toX.hg19.vcf.gz: https://sourceforge.net/projects/cellsnp/files/SNPlist/

5. Genome reference hg19
~~~~~~~~~~~~~~~~~~~~~~~~

``cellranger.hg19.3.0.0.fa`` (~3.0G). It's the fasta file for the 
human genome reference hg19. The file was pre-compiled and packaged by 
10X Genomics into a tar file `refdata-cellranger-hg19-3.0.0.tar.gz`_
(~10.4G). It was downloaded, unpacked and then renamed from 
``fasta/genome.fa`` to cellranger.hg19.3.0.0.fa.

.. _refdata-cellranger-hg19-3.0.0.tar.gz: http://cf.10xgenomics.com/supp/cell-exp/refdata-cellranger-hg19-3.0.0.tar.gz

Notes
-----

All datasets should be downloaded to ``DATA_DIR``. Its value could be specified
in `config.sh`_. Please make sure that the ``DATA_DIR`` should have the same
directory structure and file names as the `data dir`_ since many file names
are hard-coded in scripts.


.. _config.sh: https://github.com/hxj5/csp-benchmark/blob/master/config.sh
.. _data dir: https://github.com/hxj5/csp-benchmark/tree/master/data

